function dfdz = dfdZ_wJ2J3(Z)
%dfdz_wJ2J3 is a function that calculates the partials of the state
%   derivative with respect to the state, aka Jacobian. 
%
% NOTE: FUNCTION PASSES MATLAB GRADER TEST!
%
% Input:
% Z (9,1) vector of the form [x y z xdot ydot zdot mu J2 J3]'
%
% Output:
% dfdz (9,1) the derivative [xdot ydot zdot xddot yddot zddot
%            mudot J2dot J3dot]'
%

% DEFINED IN MATLAB GRADER
rE = 6378; % Spherical Earth Radius, km
    
%Unpack Z
x    = Z(1);
y    = Z(2);
z    = Z(3);
xdot = Z(4);
ydot = Z(5);
zdot = Z(6);
mu   = Z(7);
J2   = Z(8);
J3   = Z(9);

% Earth mean radius
RE = rE; %6371.0072; 

daxdx = (mu*((3*J2*RE^2*z^2)/(x^2 + y^2 + z^2)^3 + (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2 - (3*J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(3/2) - (15*z^3)/(x^2 + y^2 + z^2)^(5/2) + (75*x^2*z^3)/(x^2 + y^2 + z^2)^(7/2) - (9*x^2*z)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(x^2 + y^2 + z^2)^(5/2) - (24*J2*RE^2*x^2*z^2)/(x^2 + y^2 + z^2)^4 - (4*J2*RE^2*x^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 + (15*J3*RE^3*x^2*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) - (mu*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*x^2*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2) + (2*mu*x*((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2);
 
 
daxdy = (mu*((J3*RE^3*((9*x*y*z)/(x^2 + y^2 + z^2)^(5/2) - (75*x*y*z^3)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) + (3*J3*RE^3*x*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (24*J2*RE^2*x*y*z^2)/(x^2 + y^2 + z^2)^4 - (4*J2*RE^2*x*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 + (15*J3*RE^3*x*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*y*((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (mu*x*((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*x*y*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
daxdz = (mu*x*((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((3*x)/(x^2 + y^2 + z^2)^(3/2) - (54*x*z^2)/(x^2 + y^2 + z^2)^(5/2) + (75*x*z^4)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (3*J3*RE^3*z*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*x*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*x*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (6*J2*RE^2*x*z)/(x^2 + y^2 + z^2)^3 + (18*J2*RE^2*x*z^3)/(x^2 + y^2 + z^2)^4 + (4*J2*RE^2*x*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 - (15*J3*RE^3*x*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*z*((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*x*z*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
daxdmu = - ((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2)/(x^2 + y^2 + z^2)^(1/2) - (x*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2);
 
 
daxdJ2 = (mu*((3*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 + (RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(1/2) + (RE^2*mu*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2));
 
 
daxdJ3 = - (mu*((RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2))))/(x^2 + y^2 + z^2)^(1/2) - (RE^3*mu*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^3);
 
 
daydx = (mu*((J3*RE^3*((9*x*y*z)/(x^2 + y^2 + z^2)^(5/2) - (75*x*y*z^3)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) + (3*J3*RE^3*x*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (24*J2*RE^2*x*y*z^2)/(x^2 + y^2 + z^2)^4 - (4*J2*RE^2*x*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 + (15*J3*RE^3*x*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*y*((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (mu*x*((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*x*y*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
daydy = (mu*((3*J2*RE^2*z^2)/(x^2 + y^2 + z^2)^3 + (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2 - (3*J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(3/2) - (15*z^3)/(x^2 + y^2 + z^2)^(5/2) + (75*y^2*z^3)/(x^2 + y^2 + z^2)^(7/2) - (9*y^2*z)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(x^2 + y^2 + z^2)^(5/2) - (24*J2*RE^2*y^2*z^2)/(x^2 + y^2 + z^2)^4 - (4*J2*RE^2*y^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 + (15*J3*RE^3*y^2*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) - (mu*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*y^2*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2) + (2*mu*y*((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2);
 
 
daydz = (mu*y*((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((3*y)/(x^2 + y^2 + z^2)^(3/2) - (54*y*z^2)/(x^2 + y^2 + z^2)^(5/2) + (75*y*z^4)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (3*J3*RE^3*z*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*y*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*y*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (6*J2*RE^2*y*z)/(x^2 + y^2 + z^2)^3 + (18*J2*RE^2*y*z^3)/(x^2 + y^2 + z^2)^4 + (4*J2*RE^2*y*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 - (15*J3*RE^3*y*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*z*((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*y*z*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
daydmu = - ((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2)/(x^2 + y^2 + z^2)^(1/2) - (y*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2);
 
 
daydJ2 = (mu*((3*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 + (RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(1/2) + (RE^2*mu*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2));
 
 
daydJ3 = - (mu*((RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2))))/(x^2 + y^2 + z^2)^(1/2) - (RE^3*mu*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^3);
 
 
dazdx = (mu*x*((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((3*x)/(x^2 + y^2 + z^2)^(3/2) - (54*x*z^2)/(x^2 + y^2 + z^2)^(5/2) + (75*x*z^4)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((12*x*z)/(x^2 + y^2 + z^2)^2 - (24*x*z^3)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)) - (3*J3*RE^3*z*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*x*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*x*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) + (6*J2*RE^2*x*z^3)/(x^2 + y^2 + z^2)^4 + (4*J2*RE^2*x*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 - (15*J3*RE^3*x*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*z*((J3*RE^3*((3*x*z)/(x^2 + y^2 + z^2)^(3/2) - (15*x*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*x*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*x*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*x*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*x*z*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
dazdy = (mu*y*((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((3*y)/(x^2 + y^2 + z^2)^(3/2) - (54*y*z^2)/(x^2 + y^2 + z^2)^(5/2) + (75*y*z^4)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((12*y*z)/(x^2 + y^2 + z^2)^2 - (24*y*z^3)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)) - (3*J3*RE^3*z*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*y*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*y*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) + (6*J2*RE^2*y*z^3)/(x^2 + y^2 + z^2)^4 + (4*J2*RE^2*y*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 - (15*J3*RE^3*y*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (mu*z*((J3*RE^3*((3*y*z)/(x^2 + y^2 + z^2)^(3/2) - (15*y*z^3)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*y*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (3*J2*RE^2*y*z^2)/(x^2 + y^2 + z^2)^3 - (J2*RE^2*y*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) + (3*mu*y*z*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
dazdz = (2*mu*z*((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2) - (mu*((J3*RE^3*((39*z)/(x^2 + y^2 + z^2)^(3/2) - (114*z^3)/(x^2 + y^2 + z^2)^(5/2) + (75*z^5)/(x^2 + y^2 + z^2)^(7/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) + (J2*RE^2*(6/(x^2 + y^2 + z^2) - (30*z^2)/(x^2 + y^2 + z^2)^2 + (24*z^4)/(x^2 + y^2 + z^2)^3))/(2*(x^2 + y^2 + z^2)) - (2*J2*RE^2*z*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^2 + (3*J3*RE^3*z*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(x^2 + y^2 + z^2)^(5/2) + (4*J2*RE^2*z^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^3 - (15*J3*RE^3*z^2*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(7/2))))/(x^2 + y^2 + z^2)^(1/2) + (3*mu*z^2*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(5/2);
 
 
dazdmu = - ((J2*RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (J3*RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) + (3*J3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2)) - (J2*RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2)/(x^2 + y^2 + z^2)^(1/2) - (z*((J3*RE^3*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (J2*RE^2*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)) + 1))/(x^2 + y^2 + z^2)^(3/2);
 
 
dazdJ2 = (RE^2*mu*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(2*(x^2 + y^2 + z^2)^(5/2)) - (mu*((RE^2*((6*z)/(x^2 + y^2 + z^2) - (6*z^3)/(x^2 + y^2 + z^2)^2))/(2*(x^2 + y^2 + z^2)) - (RE^2*z*((3*z^2)/(x^2 + y^2 + z^2) - 1))/(x^2 + y^2 + z^2)^2))/(x^2 + y^2 + z^2)^(1/2);
 
 
dazdJ3 = (mu*((RE^3*(3/(x^2 + y^2 + z^2)^(1/2) - (18*z^2)/(x^2 + y^2 + z^2)^(3/2) + (15*z^4)/(x^2 + y^2 + z^2)^(5/2)))/(2*(x^2 + y^2 + z^2)^(3/2)) - (3*RE^3*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^(5/2))))/(x^2 + y^2 + z^2)^(1/2) - (RE^3*mu*z*((3*z)/(x^2 + y^2 + z^2)^(1/2) - (5*z^3)/(x^2 + y^2 + z^2)^(3/2)))/(2*(x^2 + y^2 + z^2)^3);

n = numel(Z);

dfdz = zeros([n,n]);

dfdz(1:3,4:6) = eye(3);

dfdz(4:6,1:3) = [daxdx, daxdy, daxdz;...
                 daydx, daydy, daydz;...
                 dazdx, dazdy, dazdz];

dfdz(4:6,7:9) = [daxdmu, daxdJ2, daxdJ3;...
                 daydmu, daydJ2, daydJ3;...
                 dazdmu, dazdJ2, dazdJ3];


